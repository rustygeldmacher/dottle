#!/bin/bash

if [[ "$1" == "--help" ]]; then
  echo "Show all topics being used"
  exit 0
fi

command=$1
if [[ -z "$command" ]]; then
  command=all
fi

if [[ -t 1 ]]; then
  case "$command" in
    all)
      echo "All dottle topics:"
      ;;
    using)
      echo "All topics currently in use:"
      ;;
    available)
      echo "All available topics:"
      ;;
  esac
fi

usings=$DOTTLE_HOME/topics/topics-enabled
if [[ ! -e "$usings" ]]; then
  touch $usings
fi

for topic in $(cat $usings); do
  if [[ ! -z $topic ]]; then
    if [[ -t 1 ]]; then
      echo "* $topic"
    else
      echo $topic
    fi
  fi
done

